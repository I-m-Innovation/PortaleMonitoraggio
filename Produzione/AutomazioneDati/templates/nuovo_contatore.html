{% extends 'base_layout.html' %}
{% load static %}
{% block extra_css %}
    <!-- Inclusione del CSS personalizzato per il Diario delle Letture -->
    <link rel="stylesheet" href="{% static 'css/nuovo_contatore.css' %}">
    <!-- Inclusione del CSS per Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
{% endblock extra_css %}


{% block content %}



<!-- Sezione registrazione dispositivo -->
<div class="registrazioneDispositivo">
    <!-- Div centrale posizionato SOPRA il form -->
    <div class="central-div">
        <h3>
            Registrazione Contatore {{ impianto.nome_impianto }}
        </h3>
    </div>
    
   
    
    <!-- Form per i campi obbligatori posizionato SOTTO -->
    <form id="device-registration-form" action="{% url 'salva_contatore' %}" method="post" class="device-form">
         {% csrf_token %}
         <div class="form-group">
             <label for="nome">Nome</label>
             <input type="text" id="nome" name="nome" required>
         </div>
         <div class="form-group">
             <label for="pod">POD</label>
             <input type="text" id="pod" name="pod" required>
         </div>
         <div class="form-group">
             <label for="k">K</label>
             <input type="number" id="k" name="k" required>
         </div>
         <div class="form-group">
             <label for="marca">Marca</label>
             <select name="marca" id="marca" class="form-control" onchange="checkMarca(this)">
                 <option value="">-- Seleziona una marca --</option>
                 <option value="Kaifa">Kaifa</option>
                 <option value="Gesis">Gesis</option>
                 <option value="Altro">Altro</option>
             </select>
             <input type="text" id="marca_altro" name="marca_altro" class="form-control" placeholder="Specifica altra marca" style="display:none; margin-top: 10px;">
         </div>
         <div class = "form-group">
            <label for = "tipologiafascio">Fascia</label>
            <select name = "tipologiafascio" id = "tipologiafascio" class = "form-control">
                <option value = "monofascio">Monofascia</option>
                <option value = "trifascio">Trifascia</option>
            </select>
         </div>
         <div class = "form-group">
            <label for = "matricola">Matricola</label>
            <input type = "text" id = "matricola" name = "matricola" required>
         </div>
         <div class="form-group">
             <label for="modello">Modello</label>
             <input type="text" id="modello" name="modello" required>
         </div>
         <div class="form-group">
             <label for="data_installazione">Data di installazione</label>
             <input type="date" id="data_installazione" name="data_installazione" required>
         </div>
         <div class="form-group">
             <label for="dropdown">Tipo di contatore</label>
             <select id="dropdown" name="tipologia" class="custom-select" required>
                 <option value="Produzione">Produzione</option>
                 <option value="Scambio">Scambio</option>
                 <option value="Ausiliare">Ausiliare</option>
             </select>
         </div>
         <input type="hidden" name="impianto_id" value="{{ impianto.id }}">
         <button type="submit">Invia</button>
    </form>
</div>

{% endblock content %}

{% block extra_js %}
<script>
    function checkMarca(selectElement) {
        var altroInput = document.getElementById('marca_altro');
        if (selectElement.value === 'Altro') {
            altroInput.style.display = 'block';
            altroInput.setAttribute('required', 'required'); // Fa s√¨ che il campo sia obbligatorio solo quando visibile
        } else {
            altroInput.style.display = 'none';
            altroInput.removeAttribute('required');
            altroInput.value = ''; // Pulisci il campo quando nascosto
        }
    }
</script>
{% endblock extra_js %}